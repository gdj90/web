<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>글자잡기</title>
</head>
<body>
      <script type="text/javascript">
        function nextRandomInteger(limit) {
            /*
              Math.round() : 반올림
              Math.floor() : 버림. 
              Math.ceil()  : 올림. 
            */
            return Math.round(Math.random() * limit); //0 ~ limit까지의 임의의 정수 리턴
        }
        function randomSpeed(maxSpeed) { //2 : -2 ~ 2 정도사이의 임의의 수
            return Math.random() * maxSpeed - Math.random() * maxSpeed; 
        }
        let canvasWidth = 700; //글자의 이동가능한 가로 크기
        let canvasHeight = 500; //글자의 이동가능한 세로 크기
        let total = 10;  //글자의 수.    
        //생성자 함수.
        function MovingText() { 
            //글자의 초기 위치
            this.x = nextRandomInteger(canvasWidth); //0 ~ 700사이의 임의의 정수. x축의 시작위치
            this.y = nextRandomInteger(canvasHeight);//0 ~ 500사이의 임의의 정수. y축의 시작위치
            //위치 변경 값
            this.vX = randomSpeed(2); // -2 ~ 2 정도의 임의의 값. 이동속도 제어 
            this.vY = randomSpeed(2); // -2 ~ 2 정도의 임의의 값

            this.body = document.createElement("h1"); //<h1></h1>
            this.body.innerHTML = "A";                //<h1>A</h1>
            //setAttribute : 속성 등록
            //<h1 style='background-color:white'>A</h1>
            this.body.setAttribute("style","background-color:white"); 
            //<h1 style='background-color:white; position:absolute'>A</h1>
            this.body.style.position = "absolute"; //절대경로
            let text = this.body; //<h1 style='background-color:white; position:absolute'>A</h1>
            this.body.onclick = function() {  //<h1>A</h1>클릭 이벤트 설정
                if(text.innerHTML == 'B') return;
                --total;  //차감
                alert("남은 문자 수:" + total);
                text.innerHTML = "B"; //<h1 style='background-color:white; position:absolute'>B</h1>
            }
            //화면에 추가
            document.body.appendChild(this.body);
        }
        //멤버함수를 외부에서 설정. 
        MovingText.prototype.move = function() {
            if(this.body.innerHTML == 'B') return; //잡힌글자. 움직임 없음
            //가로 범위를 이탈하는 경우. 이동방향을 변경. 
            if(this.x < 0 || this.x > canvasWidth)  {   this.vX *= -1;   }
            //세로 범위를 이탈하는 경우. 이동방향을 변경. 
            if(this.y < 0 || this.y > canvasHeight) {   this.vY *= -1;   }

            this.x += this.vX; //가로 위치의 값을 변경
            this.y += this.vY; //세로 위치의 값을 변경 
            this.body.style.left = this.x + "px"; //h1태그의 가로 위치 지정
            this.body.style.top = this.y + "px";  //h1태그의 세로 위치 지정
            //<h1 style='background-color:white; position:absolute; left=100px; top:98px;'>A</h1>
        }
        //화면이 시작된경우. 
        window.onload = function() {
            let movingTexts = []; //배열 객체 생성
            for(let i=0;i<10;i++) {
                movingTexts.push(new MovingText());
            }
            //setInterval(함수,밀리초) : 밀리초마다 함수 실행
            let game = setInterval(function(){  //1초에 60번 호출
                for (let i in movingTexts) {
                    if(total < 4) {
                        alert("게임종료");
                        //clearInterval(interval_id) : setInterval 취소
                        clearInterval(game);
                        return;
                    }
                    //movingTexts[i] : MovintText 객체 
                    movingTexts[i].move(); 
                }
            },1000/60);
        }
     </script>         
</body>
</html>