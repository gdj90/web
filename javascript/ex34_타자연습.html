<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style type="text/css">
        div {	position: absolute; }
        #main { width: 450px;    	    height: 400px;
                border: 1px solid blue;	overflow: hidden;   }
        input {
            position: absolute;	top: 410px;
            left: 10px;   	size: 200px;
        }
        #scorearea {  position: absolute;	top: 410px;
            left: 210px;   	
            border : 1px solid #333333;
            width : 200px; height:20px;
        }
        #score {
            position: relative;	left: 30px;   
            display: inline;	
        }
    </style>
</head>
<body>
    <div id="main"></div> <!-- 단어 표시되는 영역-->
    <div style="width: 400px">
        <!--
           단어 입력 공간.
           onchange : value 값이 변경 될때 발생되는 이벤트. checkbox, select,....
           this.value : 입력된 값 
        -->
       <input type="text" onchange="deleteMode(this.value)" id="input">
       <div id="scorearea">점수: <div id="score"></div></div>
    </div> 
<script>
    //2차원 배열로 생성
    let datas = [
    ["태연","유리","윤아","효연","수영","서현", "티파니", "써니", "제시카"],
    ["정국","뷔","지민","슈가","진","알앰","제이홉"],
    ["미나","나연","다현","지효","모모","채영","쯔위","사나","정연"] ]
  let cnt=0; 
  let words=[]; //화면에 출력되는 단어 저장한 배열
  let colors=['red', 'blue', 'green', 'grey', 'orange', 'black','pink'] //글자색을 선택
  let canvasWidth = 400;
  let canvasHeight = 400;
  //화면 준비완료
  window.onload=function() {
      cm = setInterval(createMode, 2000); //2초에 한번씩  createMode 함수 호출. 데이터 추가 기능
      mm = setInterval(moveMode, 2000);   //2초에 한번씩 moveMode 함수 호출. 단어 이동
  }
  function MovingChar() { //생성자
      this.h3 = document.createElement('h3'); //
      this.h3.innerHTML = randomData(); //datas 배열에서 한개 단어 리턴
      this.x = random(canvasWidth); //가로 위치 설정
      this.y = 0;                   //세로 위치 설정
      this.vY = 10;                 //세로 위치 이동 간격
      this.h3.style.position = 'absolute';
      this.h3.style.left = this.x + 'px';
      this.h3.style.color = colors[random(colors.length)];
      document.querySelector("#main").appendChild(this.h3);
  }
  //MovingChar 멤버 함수
  MovingChar.prototype.move = function () {
      if ((this.x+this.h3.innerHTML.length)>canvasWidth) {
          this.x = canvasWidth-(this.h3.innerHTML.length+1); //가로의 위치 보정
      }
      this.y += this.vY; //위치 설정
      this.h3.style.top = this.y + 'px';  //세로의 위치 이동
  };
  MovingChar.prototype.remove = function () {
      document.querySelector("#main").removeChild(this.h3);
  };
  function createMode() { //2초에 한번씩 호출됨.
      words.push(new MovingChar()); //배열에 추가
  }
  function moveMode() {  //2초에 한번씩 호출됨
      for (let i in words) {
        //words[i] : MovingChar 객체 한개.
        words[i].move();  //세로위치 이동
        if (words[i].y>=canvasHeight-30) { //바닥에 단어가 닿음. 게임 종료상황
         document.querySelector("#main").removeChild(words[i].h3);
         delete (words[i]) //배열에서 삭제
         clearInterval(cm); //단어 추가 종료
         clearInterval(mm); //단어 이동 종료
         for(let j in words) {
            words[j].h3.style.color = "gray"  //단어 색을 회색으로 변경
         }
         alert("게임 종료") 
       }
      } 
  }
  function random(num) {
      let num1 = Math.random()* num;
      num1 = parseInt(num1);
      return num1; //0 ~ num-1 사이의 임의의 정수
  }
  function randomData() { //데이터 추가시 데이터 선택
      let num1 = Math.random()* 3;  
      num1 = parseInt(num1);  //소녀시대, BTS,트와이스  중 한개 선택
      let num2 = Math.random()* datas[num1].length;
      num2 = parseInt(num2);
      return datas[num1][num2];  //datas 2차원배열임. 
  } 
  function deleteMode(str) {   //입력값을 화면에서 해당 이름 제거
      //str : 입력한 데이터
      for (let i in words) {  //중복된 데이터 모두 제거됨
          words[i].move();
          if (words[i].h3.innerHTML == str) {
             document.querySelector("#main").removeChild(words[i].h3); //화면에서 제거
             delete (words[i])  //배열 제거
             score.innerHTML=++cnt //점수 증가
          }
      }
      //다음 입력 준비 초기화
      document.querySelector("#input").value="";  //입력 란을 초기화
      document.querySelector("#input").focus();   //입력 란에 focus 유지
  } 
  </script></body></html>